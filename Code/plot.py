import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

sns.set(style="ticks")


data = [
[

('shape', 'congressional_districts', '1', '28', 'ols', 59.95739777215104, 45.86379613318605, 'sols', 61.915301408780017, 45.045295704912498, 45.0),
('shape', 'congressional_districts', '7', '28', 'ols', 77.64605841825724, 64.44434809584493, 'sols', 76.501250333189532, 61.480812048501129, 45.0),
('shape', 'congressional_districts', '14', '28', 'ols', 70.562919752199392, 58.772685175888427, 'sols', 74.7936872894104, 60.037556235804963, 45.0),
('shape', 'congressional_districts', '28', '28', 'ols', 81.229026456794216, 72.848194776318692, 'sols', 83.659684102689056, 75.170464665724026, 44.0),
('shape', 'congressional_districts', '56', '28', 'ols', 90.285557657024057, 64.734343158397309, 'sols', 104.28011335471209, 79.750629867415753, 45.0),
],
[
('shape', 'neighborhoods', '1', '28', 'ols', 3.9763923518130833, 1.4999714798096029, 'sols', 3.935959582964871, 1.515737565596017, 313.0),
('shape', 'neighborhoods', '7', '28', 'ols', 3.9030231853454045, 1.0668194864289309, 'sols', 3.8704067508038973, 1.0576792404262398, 324.0),
('shape', 'neighborhoods', '14', '28', 'ols', 3.9701894877298312, 1.1369498923371204, 'sols', 3.9494130121945079, 1.2234480537902817, 312.0),
('shape', 'neighborhoods', '28', '28', 'ols', 3.9201972939439669, 1.2318447150554159, 'sols', 3.9004329262394992, 1.2320118378281102, 312.0),
('shape', 'neighborhoods', '56', '28', 'ols', 4.1078956700465064, 1.0444297650003012, 'sols', 4.1192525876987522, 1.0451690947747458, 487.0)
],
[
('shape', 'police_districts', '1', '28', 'ols', 16.517106440339397, 6.1737432712264031, 'sols', 16.08652045943499, 5.9446862865375376, 132.0),
('shape', 'police_districts', '7', '28', 'ols', 15.945639348685122, 6.4362966831323751, 'sols', 15.903406280585555, 6.3313145665333739, 95.0),
('shape', 'police_districts', '14', '28', 'ols', 16.700164174192199, 6.2207036231340798, 'sols', 16.286555599414363, 6.2562180677620329, 93.0),
('shape', 'police_districts', '28', '28', 'ols', 17.406228252214802, 7.7804894149333377, 'sols', 17.426845490430015, 8.1781036534418217, 93.0),
('shape', 'police_districts', '56', '28', 'ols', 17.686488944948007, 6.3755184458439143, 'sols', 18.111521509426559, 6.5841103419167384, 92.0),
],
[
('shape', 'state_senate_districts', '1', '28', 'ols', 22.106008863378893, 11.347379405579479, 'sols', 21.287267385003698, 10.69558970175026, 84.0),
('shape', 'state_senate_districts', '7', '28', 'ols', 20.987567767038467, 10.674387219488413, 'sols', 20.551041966710301, 10.492826163296929, 84.0),
('shape', 'state_senate_districts', '14', '28', 'ols', 22.156232776684512, 10.841970951911778, 'sols', 21.304403194781113, 10.090230724356005, 82.0),
('shape', 'state_senate_districts', '28', '28', 'ols', 20.85576522203624, 10.007768816704626, 'sols', 20.98289913235314, 10.281542790286034, 82.0),
('shape', 'state_senate_districts', '56', '28', 'ols', 23.796303745266531, 11.516690881593703, 'sols', 23.557385738016869, 11.987694739607461, 82.0),
],
[
('shape', 'tax_increment_financing_districts', '1', '28', 'ols', 1.5750049363165519, 0.62627298819015498, 'sols', 1.586630753335055, 0.64408675116276004, 286.0),
('shape', 'tax_increment_financing_districts', '7', '28', 'ols', 1.5247953759745303, 0.53115637086713252, 'sols', 1.5574548844146243, 0.53296237621355302, 287.0),
('shape', 'tax_increment_financing_districts', '14', '28', 'ols', 1.5299510688405411, 0.61159640227112733, 'sols', 1.5347338971969831, 0.59518850821056712, 288.0),
('shape', 'tax_increment_financing_districts', '28', '28', 'ols', 1.5894525781817663, 0.61539077913534135, 'sols', 1.6060313503523196, 0.62535047025527013, 288.0),
('shape', 'tax_increment_financing_districts', '56', '28', 'ols', 1.567983958945349, 0.57127533642653616, 'sols', 1.5853536915068196, 0.56133191621099443, 286.0)
],
[
('shape', 'wards', '1', '28', 'ols', 7.2481795613007671, 2.5705074196034845, 'sols', 7.1313053873156012, 2.6281126193658895, 189.0),
('shape', 'wards', '7', '28', 'ols', 7.6486194461597901, 2.6504489681716548, 'sols', 7.5314071768128148, 2.7334756201881087, 190.0),
('shape', 'wards', '14', '28', 'ols', 7.4963940355726315, 2.2448936923681044, 'sols', 7.3429847893587565, 2.2215633256802358, 187.0),
('shape', 'wards', '28', '28', 'ols', 7.6530441884980203, 3.2460597101964015, 'sols', 7.4917108091480245, 3.3613101905460376, 186.0),
('shape', 'wards', '56', '28', 'ols', 7.9361801045555254, 2.6605094593597114, 'sols', 7.8325499098017248, 2.5926505572134011, 188.0)
],
[
('shape', 'police_beats', '1', '28', 'ols', 1.2396649311627459, 0.58441742072993808, 'sols', 1.2344355043150335, 0.58788089337354543, 915.0),
('shape', 'police_beats', '7', '28', 'ols', 1.2255282500811462, 0.40184356141146627, 'sols', 1.2225604144962481, 0.40202193049938589, 882.0),
('shape', 'police_beats', '14', '28', 'ols', 1.2089522890050575, 0.47869148152709262, 'sols', 1.205197590038726, 0.47473018772974734, 876.0),
('shape', 'police_beats', '28', '28', 'ols', 1.2104920322965786, 0.42887532037704279, 'sols', 1.2056941729477839, 0.4277437351425698, 881.0),
('shape', 'police_beats', '56', '28', 'ols', 1.3345576732978981, 0.82135665458344442, 'sols', 1.3288085026679171, 0.81075953772627174, 870.0)
],
[
('shape', 'ward_precincts', '1', '28', 'ols', 0.32927305820232933, 0.058647713574317528, 'sols', 0.32888470355217747, 0.058840306293623613, 2397.0),
('shape', 'ward_precincts', '7', '28', 'ols', 0.34531495036824622, 0.14791410176244008, 'sols', 0.34485238365765786, 0.14863911980184394, 2413.0),
('shape', 'ward_precincts', '14', '28', 'ols', 0.3301423799751666, 0.063290053601984045, 'sols', 0.32949294980543908, 0.06329855795934973, 2408.0),
('shape', 'ward_precincts', '28', '28', 'ols', 0.35186228014010978, 0.14431614141016902, 'sols', 0.35119854504839887, 0.14373137825774676, 2379.0),
('shape', 'ward_precincts', '56', '28', 'ols', 0.34948318428461478, 0.14403583534830516, 'sols', 0.34890755365303322, 0.1453984913191273, 2438.0),
],
[
('shape', 'zip_codes', '1', '28', 'ols', 6.3073053108093653, 2.159614905680773, 'sols', 6.2668725729939778, 2.19664245019763, 205.0),
('shape', 'zip_codes', '7', '28', 'ols', 6.4197068641936559, 2.0642498875146367, 'sols', 6.3293079800981964, 1.9596151877541175, 205.0),
('shape', 'zip_codes', '14', '28', 'ols', 6.4456964559798875, 2.4232999591479203, 'sols', 6.387855025732323, 2.4470817114240733, 205.0),
('shape', 'zip_codes', '28', '28', 'ols', 6.6860139124141709, 2.8150495391267683, 'sols', 6.602148454539539, 2.8001599731266054, 206.0),
('shape', 'zip_codes', '56', '28', 'ols', 6.6269046690156941, 1.9606603129971947, 'sols', 6.5964125545023045, 1.9600766741706137, 205.0)
]
]


for group in data:
	name 		= group[0][1]
	ols_xs 		= []
	ols_x_low 	= []
	ols_x_high 	= []

	sols_xs 	= []
	sols_x_low 	= []
	sols_x_high = []

	max_mse = 0
	sd = group[0][6]


	for obs in group:
		print obs
		ols_mse = obs[5]
		ols_sd = obs[6]
		
		sols_mse = obs[8]
		sols_sd = obs[9]
		if ols_mse + ols_sd > max_mse:
			max_mse = ols_mse + ols_sd

		if sols_mse + sols_sd > max_mse:
			max_mse = sols_mse + sols_sd

		ols_xs.append(ols_mse)
		ols_x_low.append(ols_mse - ols_sd)
		ols_x_high.append(ols_mse + ols_sd)

		sols_xs.append(sols_mse)
		sols_x_low.append(sols_mse - sols_sd)
		sols_x_high.append(sols_mse + sols_sd)

	x = [1, 2, 3, 4, 5]
	y = ols_xs
	
	fig = plt.figure()
	ax = fig.add_subplot(111)
	plt.errorbar(x, ols_xs,  yerr=ols_sd, label='OLS')
	plt.errorbar(x, sols_xs, yerr=sols_sd, label='Spatial OLS')
	plt.title("MSE of Crime Prediction for %s" % ' '.join(name.split('_')).title())
	plt.legend()
	ax.set_xticklabels(['', 1, 7, 14, 28, 56])
	ax.set_xlabel("# Days in the furture of the Prediction")
	ax.set_ylabel("Mean Squared Error with Standard Deviation")
	plt.xlim(0, 6)
	plt.ylim(0, max_mse*1.1)
	plt.savefig("graphs/%s.png" % name)
	plt.cla()
	